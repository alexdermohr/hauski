wgx:
  apiVersion: v1
  requiredWgx: "^2.0"
  requiredCapabilities:
    - task-router
    - manifest-validate
    - json-output
  repoKind: "hauski"
  dirs:
    web: ""
    api: "crates"
    data: ".local/state/hauski"
  tasks:
    doctor:
      desc: "Sanity-Checks"
      safe: true
      cmd: cargo
      args:
        - run
        - -p
        - hauski-cli
        - --
        - doctor
    serve:
      desc: "Entwicklungsserver"
      cmd: cargo
      args:
        - run
        - -p
        - hauski-cli
        - --
        - serve
    test:
      desc: "Workspace-Tests"
      safe: true
      cmd: cargo
      args:
        - test
        - --workspace
        - --
        - --nocapture
    fmt:
      desc: "Formatierung"
      cmd: cargo
      args:
        - fmt
        - --all
    clippy:
      desc: "Clippy-Lints"
      cmd: cargo
      args:
        - clippy
        - --all-targets
        - --all-features
        - --
        - -D
        - warnings
    'run semantah:all':
      desc: "SemantAH-Pipeline (Index, Graph, Related)"
      cmd: make
      args:
        - -C
        - tools/semantah
        - all
    'run semantah:related':
      desc: "Nur Related-Writer ausf√ºhren"
      cmd: make
      args:
        - -C
        - tools/semantah
        - related
    'guard semantah':
      desc: "Config validieren & Related-Writer Dry-Run"
      safe: true
      cmd: bash
      args:
        - -c
        - |
          set -euo pipefail
          cargo run -p hauski-cli -- config validate
          make -C tools/semantah related CHECK=1
  envDefaults:
    RUST_LOG: "info,hauski=debug"
